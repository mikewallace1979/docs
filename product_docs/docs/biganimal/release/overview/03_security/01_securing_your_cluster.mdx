---
title: "Enforcing ASC policy definitions"
---

For each subscription belonging to your organization, Azure automatically assigns a default set of policies to ensure baseline security. You can customize these default policies to match BigAnimal's specific requirement to furhter harden security in your resources. 

## Customize the default ASC policy

Perform the following steps for each of your Azure subscriptions:

1. In the Azure portal, enter **Policy** in the search box at the top and open the Policy service.

1. Select **Compliance** on the left side of the Policy page. 

1. On the Policy | Compliance page, set the Scope by selecting the ellipsis and then selecting all subscriptions. 
 Click the **Select** button at the bottom of the Scope page to add your selection.

1. You can see a list of all the policy initiatives (sets of polices) automatically assigned by Azure as part of onboarding. The policy initiative for each subscription is labelled as **ASC Default (subscription: <Subscription_ID>)**

1. Select a policy inititative in the list and click **Edit assignment**  

1. On the Edit Initiative Assignment page click the **Parameters** tab.

1. Clear the **Only show parameters that need input or review** check box.

1. Configure the parameters in your default ASC policy to only allow BigAnimal's specific requirements. Use the JSON values in ()[] to update the parameters.

1. To remediate non-compliant resources, select Next at the bottom of the page or the Remediation tab at the top of the page to move to the next segment of the assignment wizard. See 

### Security configurations required by BigAnimal

Use the values below each of the parameters to configure the default ASC policy of a subscription. 

!!! Note
   You can directly copy the JSON values provided below, if applicable.

##### Allowed container ports list

**JSON value**:

```js

["5432",  "9187",  "8000",  "9000",  "9443",  "9402",  "10250",  "9090",  "8080",  "8443",  "2020", "3000",  "6443", "9100",  "9102",  "9201",  "8081"]

```

##### Allowed service ports list in Kubernetes cluster

**JSON value**:

```js

["5432",  "9402",  "443", "8080",  "9090",  "3000",  "8443",  "9443",  "9100", "9201"]

```

##### Allowed AppArmor profiles

**JSON value**:

```js

["runtime/default"]

```
 
##### Allowed capabilities   

**JSON value**:

```js

["FOWNER"]

```

##### Max allowed memory bytes in Kubernetes cluster 

**Value**: `6Gi`



##### Max allowed CPU units in Kubernetes cluster 

**Value**: `2` 


##### Allowed host paths 

**JSON value**:

```js

{
 "paths": [
   {
     "pathPrefix": "/var/log",
     "readOnly": false
   },
   {
     "pathPrefix": "/var/lib/docker/containers",
     "readOnly": true
   },
   {
     "pathPrefix": "/",
     "readOnly": true
   },
   {
     "pathPrefix": "/sys",
     "readOnly": true
   },
   {
     "pathPrefix": "/proc",
     "readOnly": true
   },
   {
     "pathPrefix": "/var/run/docker.sock",
     "readOnly": false
   },
   {
     "pathPrefix": "/run/containerd/containerd.sock",
     "readOnly": false
   },
   {
     "pathPrefix": "/dev",
     "readOnly": false
   },
   {
     "pathPrefix": "/boot",
     "readOnly": true
   },
   {
     "pathPrefix": "/lib/modules",
     "readOnly": false
   },
   {
     "pathPrefix": "/usr",
     "readOnly": true
   },
   {
     "pathPrefix": "/etc",
     "readOnly": true
   }
 ]
}

```


### Remediate non-compliant resources 

Once you have modified the default ASC policy definition parameters, ensure that your resources are compliant with BigAnimal's security requirements from Remediation tab of the assignment wizard. Perform the following steps: 

1. Leave Create a Managed Identity unchecked. This box must be checked when the policy or initiative includes a policy with either the deployIfNotExists or modify effect. As the policy used for this quickstart doesn't, leave it blank. For more information, see managed identities and how remediation security works.

1. Select Next at the bottom of the page or the Non-compliance messages tab at the top of the page to move to the next segment of the assignment wizard.

1. Set the Non-compliance message to **TBD** . This custom message is displayed when a resource is denied or for non-compliant resources during regular evaluation.

1. Select Next at the bottom of the page or the Review + Create tab at the top of the page to move to the next segment of the assignment wizard.

1. Review the selected options, then select Create at the bottom of the page.


## Remediate resources in your cluster

You're now ready to monitor and identify non-compliant resources to understand the compliance state of the resources in your subscription.

Select Compliance in the left side of the page. If there are any existing resources that aren't compliant with this new assignment, they appear under non-compliant resources.

When a condition is evaluated against your existing resources and found true, then those resources are marked as non-compliant with the policy. The following table shows how different policy effects work with the condition evaluation for the resulting compliance state. Although you don't see the evaluation logic in the Azure portal, the compliance state results are shown. The compliance state result is either compliant or non-compliant.