---
title: "Reviewing Microsoft Defender for Cloud recommendations"
---

When using BigAnimal, Microsoft Defender for Cloud makes certain recommendations. See the following sections to understand why Microsoft raises some alerts and whether you can take steps to improve security in your cluster.

## Restrict unauthorized network access

Microsoft Defender for Cloud may raise the following network access issues for a BigAnimal deployment:

#### Usage of host networking and ports should be restricted

To avoid the possibility of a compromised container, Microsoft recommends restricting access to the host network for Kubernetes pods as well as restricting pod access to an allowable range of ports on the host. 

However, BigAnimal runs some containers that may use the node network namespace to monitor network traffic statistics of Kubernetes cluster worker nodes. To prevent any traffic sniffing and configuration changes to the worker node system, BigAnimal has removed all security capabilities for those containers. 

#### Virtual networks should be protected by Azure Firewall

BigAnimal does not enable the Azure Firewall. Instead, BigAnimal uses Azure Network Security Group whitelists to specify permissible inbound and outbound traffic.

If your organization requires an Azure Firewall for compliance purposes, contact [support@biganimal.com](mailto:support@biganimal.com).

## Manage access and permissions

Microsoft Defender for Cloud may raise the following access and permission issues for a BigAnimal deployment. 

#### Privileged containers should be avoided

Microsoft recommends avoiding privileged containers because they have all the root capabilities of a host machine. However, BigAnimal must run some containers in privileged mode for control plane functionality, such as securing and monitoring the application.

#### Immutable (read-only) root filesystem should be enforced for containers

Microsoft recommends that containers should run with an immutable read-only root file system in a Kubernetes cluster. Immutable file systems can prevent malicious changes at run-time. 

Some BigAnimal containers must run with a read-only root filesystem for control plane functionality. This capability is necessary, for example, to use system calls to secure and monitor the BigAnimal application.

## Running containers as root user should be avoided

Microsoft recommends that containers should not run as root. Running a process as the root user inside a container runs the process as root on the host. If a compromise occurs, an attacker has root access in the container.

BigAnimal must run some containers as the root user to provide some aspects of control plane functionality, such as logging. BigAnimal tightly restricts use of the root user, and no containers running as root expose network connectivity.

## Containers sharing sensitive host namespaces should be avoided

To protect against privilege escalation outside a container, Microsoft recommends you avoid pod access to sensitive host namespaces (that is, host process IDs and host IPCs) in a Kubernetes cluster.

However, to monitor network traffic statistics for cluster worker nodes, BigAnimal must run some containers that can share the host process ID namespace. To prevent any traffic sniffing and worker node system configuration changes, BigAnimal has eliminated *all* security capabilities from those containers.

## Container with privilege escalation should be avoided

To prevent a process from gaining more privilege than its parent process, Microsoft recommends that containers shouldn't run with privilege escalation to root in a Kubernetes cluster. The AllowPrivilegeEscalation attribute controls whether a process can gain more privileges than its parent process.

To enable some monitoring capabilities for Kubernetes, BigAnimal must run some containers that may allow privilege escalation. 

## Enable auditing and logging

Microsoft recommends enabling diagnostic logs in Virtual Machine Scale Sets and Key Vault. 

BigAnimal does not enable diagnostic logs for Virtual Machine Scale Sets and Key Vault, but it does enable diagnostic logs for Kubernetes services. Resources managed by BigAnimal are logged in Kubernetes service logs. If you must enable other logs for compliance purposes, contact [support@biganimal.com](mailto:support@biganimal.com).

## Enable enhanced security features

Microsoft Defender for Cloud now includes the capabiilities of Microsoft Defender for open-source relational databases. 

BigAnimal does not enable any of the following capabilities:
- Microsoft Defender for servers
- Microsoft Defender for Storage
- Microsoft Defender for Key Vault
- Microsoft Defender for Containers
- Microsoft Defender for Kubernetes Service clusters
- Microsoft Defender for Resources Manager
- Microsoft Defender for DNS 

If you have questions about enabling any of those capabilities for BigAnimal, contact [support@biganimal.com](mailto:support@biganimal.com).

## Implement security best practices

Microsoft Defender for Cloud may suggest the following best practice for a BigAnimal deployment:

## Kubernetes clusters should disable automounting API credentials

Microsoft recommmends disabling automounting API credentials to prevent a potentially compromised pod from running API commands against a Kubernetes cluster. 

To prevent this scenario, BigAnimal created service accounts and roles with least privileges for Kubernetes operators and operands.

